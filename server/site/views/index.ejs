<% layout('__layout') -%>

<% script('/javascripts/router/indexRouter.js') -%>
<% script('/javascripts/controllers/questionController.js') -%>
<% script('/javascripts/views/questionsView.js') -%>
<% script('/javascripts/views/tagView.js') -%>


<script type='text/x-handlebars', data-template-name='tag'>
  <span class='label label-default mrm'>
    <a data-toggle='popover' {{bindAttr data-content='description'}} {{bindAttr data-original-title='name'}} {{bindAttr href='selfurl'}}>{{name}}</a>
  </span>
</script>

<script type='text/x-handlebars', data-template-name='tags'>
  <ul class='tagCloud-container pan mtm'>
  {{#each tag in tags itemController="question"}}
    <li class='tag-container'>
      {{render 'tag' tag}}<small class='muted'>x {{abbreviateNumber tag.questioncount}}</small>
    </li>
  {{else}}
    <div class='row'>
      <div class='col-xs-12 col-sm-12 col-lg-12'>
        <h5 class='muted mtm'>No related tags.</h5>
      </div>
    </div>
  {{/each}}
  </ul>
</script>

<script type='text/x-handlebars', data-template-name='questions'>
  {{outlet headerBar}}
  
  <div class='container'>
    <div class='content'>
      <div class='row question-list-page'>
        <div class='col-xs-12 col-sm-12 col-lg-9 z-index-1'>
          <div class='mainSection'>
            <div class='row contentTitle'>
              <div class='col-xs-12 col-sm-7 col-lg-7'>
                <h1 class='mtm' id='h1Sortedby'></h1>
              </div>
              <div class="col-xs-12 col-sm-5 col-lg-5">
                <div class="sortGroup btn-group" >
                  <a id='apopular' href='/?sort=popular' class="btn btn-danger">Popular</a>
                  <a id='alatest' href='/?sort=latest' class="btn btn-danger">Latest</a>
                  <a id='aunresolved' href='/?sort=unresolved' class="btn btn-danger">Unresolved</a>
                </div>
              </div>
            </div>
            <div class='question-list'>
              {{#each question in questions itemController="question"}}
                <div {{bindAttr class=":question :row isanswered:isanswered"}}>
                  <div class='col-xs-12 col-sm-1 col-lg-1'>
                    <div class='user-profile'>
                      <div class='divPic'>
                        <a class='user-img' {{bindAttr href='author.url'}} {{bindAttr title='author.fullname'}}>
                          <img {{bindAttr src='author.smallimgurl'}}/>
                        </a>
                      </div>
                      <div class='divUserDetails'>
                        <div class='divUser'>
                          <a {{bindAttr href='author.url'}} {{bindAttr title='author.fullname'}}>
                            <span class='name'>{{author.fullname}}</span>&nbsp;<span class='spanPosted'>asked...</span>
                          </a>
                        </div>
                        <div class='divPts'>{{abbreviateNumber author.reputation}}</div>
                      </div>
                    </div>
                  </div>
                  <div {{bindAttr class=':col-xs-12 view.questionlist:col-sm-9:col-sm-11 view.questionlist:col-lg-9:col-lg-11'}}>
                    <div {{bindAttr class=':row view.questionpage:border-bottom'}}>
                      <div class='col-xs-12 col-sm-12 col-lg-12'>
                        <div class='entity-info-container'>
                          <div {{ bindAttr class='view.questionpage:question-bookmark:hide'}}>
                            <i class="icon-star"></i>
                          </div>
                          <div class='entity-info'>
                            <div class='entity-title'>
                              <div class='pbxs'>
                                <h1>
                                  <a {{bindAttr title='text'}} {{bindAttr href='url'}}>
                                    {{#if view.entitylist}}
                                      {{#if isquestion}}
                                        Q: 
                                      {{else}}
                                        A: 
                                      {{/if}}
                                    {{/if}}
                                    {{title}}
                                  </a>
                                </h1>
                              </div>
                            </div>
                            <div class='divUser'>
                              <span class='spanPosted muted font9'>asked by </span>
                              <a {{bindAttr href='author.url'}} {{bindAttr title='author.fullname'}}>
                                <span class='name'>{{author.fullname}}</span>
                              </a>
                            </div>
                            <div class='separator'></div>
                            <div class='entity-details'>
                              <span class="mrs">{{votecount}} {{pluralize votecount s='vote'}}</span>
                              <span class='mrs'>&#8226; {{answercount}} {{pluralize answercount s='answer'}} </span>
                              <span class='mrs'>&#8226; {{viewcount}} {{pluralize viewcount s='view'}}</span>
                            </div>
                            <div class='question-tag'>
                              <div class='pts pbm tag-container'>
                                {{#each tag in tags}}
                                  {{render 'tag' tag}}
                                {{/each}}
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class='row'>
                      <div class='col-xs-12 col-sm-12 col-lg-12 font9'>
                        <div {{bindAttr class='view.questionpage:ptm :pbm'}}>
                          {{text}}... <a {{bindAttr href='url' title='Click to read more'}}>more</a>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div {{bindAttr class=':col-xs-12 :col-sm-2 :col-lg-2 view.questionlist:show:hide'}} >
                    <div class='divTime'>
                      {{sincetime __utcdatecreated}}
                    </div> 
                  </div>
                </div>
              {{else}}
                <div class='row'>
                  <div class='col-xs-12 col-sm-12 col-lg-12'>
                    <h5 class='muted mtm'>Be first to add a question to this forum.</h5>
                  </div>
                </div>
              {{/each}}
            </div>
          </div>
        </div>
        <div class='col-xs-12 col-sm-12 col-lg-3 z-index-0'>
          <div class='sideSection'>
            <div class='row contentTitle'>
              <div class='col-xs-12 col-sm-12 col-lg-12'>
                <h1 class='related-tags'>Related Tags</h1>
              </div>
            </div>
            <div class='row'>
              <div class='col-xs-12 col-sm-12 col-lg-12'>
                {{outlet relatedTags}}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  {{render 'footer'}}
</script>